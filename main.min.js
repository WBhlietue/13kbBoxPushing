function Tween({from:e=0,to:n=1,duration:t=100,ease:l=(e=>e),onUpdate:o=(()=>{}),onComplete:a=(()=>{})}){function s(n){y&&(null!=n&&(null!=m&&(p+=n-m),m=n),p>=t?(o(l(1)*c+e),a&&a(),y=!1):o&&o(l(p/t)*c+e),requestAnimationFrame(s))}function d(){y=!1}function i(){p=0}function r(){p=0,y=!1,o(e)}const c=n-e;let m;var p=0,y=!0;return requestAnimationFrame(s),{Kill:d,Reload:i,Reset:r}}function ResizeWindow(){let e,n=window.innerWidth-windowBorder,t=window.innerHeight-windowBorder,l=1;e=t/gameWindow.offsetHeight*gameWindow.offsetWidth,l=e<n?e/gameWindow.offsetWidth:n/gameWindow.offsetWidth,centerX=gameWindow.offsetWidth/2,centerY=gameWindow.offsetHeight/2,gameWindow.style.transform="translate(-50%, -50%)scale("+l+")"}function PlayerMove(e,n,t=0,l=!0){let o,a,s=!1;if(boxPos.map(e=>{e[0]==n[0]&&e[1]==n[1]&&(s=!0,o=boxes[boxPos.indexOf(e)],a=e)}),!s&&!l)return 3==currentMap[n[0]][n[1]]||0==currentMap[n[0]][n[1]];if(!moving){let s=[n[0],n[1]];if("KeyA"==e||"ArrowLeft"==e)n[1]>0&&s[1]--;else if("KeyD"==e||"ArrowRight"==e)n[1]<mS-1&&s[1]++;else if("KeyW"==e||"ArrowUp"==e)n[0]>0&&s[0]--;else{if("KeyS"!=e&&"ArrowDown"!=e)return!1;n[0]<mS-1&&s[0]++}let d=PlayerMove(e,s,t+1,!1);return d&&(moving=!0,MoveDIR(s[1]-n[1],!1,l?player:o,l?playerPos:a),MoveDIR(s[0]-n[0],!0,l?player:o,l?playerPos:a)),Check(),d}return!1}function MoveDIR(e,n,t,l){0!=e&&(l=Move(t,e,l,n))}function Move(e,t,l,o){l[o?0:1]+=t;let a=o?e.style.top:e.style.left;return Tween({from:parseFloat(a.substring(0,a.length-2)),to:s*(l[o?0:1]-n)+(o?centerY:centerX),onComplete:()=>{moving=!1},onUpdate:n=>{o?e.style.top=n+"px":e.style.left=n+"px"}}),l}function Check(){if(inGaming){var e=!0;for(let n=0;n<boxPos.length;n++)if(3!=currentMap[boxPos[n][0]][boxPos[n][1]]){e=!1;break}e&&(inGaming=!1,console.log("win"),endWindow.style.display="block")}}function LoadLevel(e){function t(e){const n=document.createElement("div"),t=document.createElement("img");if("h"==e){const e=document.createElement("div");e.className="hole",n.appendChild(e)}return n.style.width=s+"px",n.style.height=s+"px",t.src="src/"+("h"==e?"g":e)+".png",n.className="element",n.appendChild(t),n}function l(){for(let l=0;l<mS;l++)for(let o=0;o<mS;o++){let a="";switch(currentMap[l][o]){case 0:a="g";break;case 1:a="wall";break;case 2:a="wall2";break;case 3:a="h";break;case 4:a="g",currentMap[l][o]=0,boxPos.push([l,o]);break;case 5:a="g",currentMap[l][o]=0,playerPos=[l,o]}var e=t(a);e.style.left=s*(o-n)+centerX+"px",e.style.top=s*(l-n)+centerY+"px",game.appendChild(e)}player=t("player"),game.appendChild(player),player.style.left=s*(playerPos[1]-n)+centerX+"px",player.style.top=s*(playerPos[0]-n)+centerY+"px",boxPos.map(e=>{let l=t("box");l.style.left=s*(e[1]-n)+centerX+"px",l.style.top=s*(e[0]-n)+centerY+"px",boxes.push(l),game.appendChild(l)})}currentMap=[],currentLevel=e;for(let n=0;n<mS;n++){let t=[];for(let l=0;l<mS;l++)t.push(levels[e][n][l]);currentMap.push(t)}playerPos=[0,0],moving=!1,boxPos=[],boxes=[],inGaming=!0,game.innerHTML="";var o=document.createElement("div");o.className="bar";var a=document.createElement("img");a.src="src/restart.png",a.className="restart",a.addEventListener("click",()=>{LoadLevel(e),endWindow.style.display="none",howWindow.style.display="none"}),o.appendChild(a);var d=document.createElement("img");d.src="src/how.png",d.className="restart",d.addEventListener("click",()=>{howWindow.style.display="block"}),o.appendChild(d);var i=document.createElement("img");i.src="src/home.png",i.className="restart",i.addEventListener("click",()=>{game.style.display="none",startWindow.style.display="block",endWindow.style.display="none",howWindow.style.display="none"}),o.appendChild(i),game.appendChild(o);var r=document.createElement("div");r.className="levelText",r.innerHTML="Level "+(e+1),game.appendChild(r);var c=document.createElement("div");c.className="timeText",c.innerHTML="Time: 0",game.appendChild(c);var m=document.createElement("div");m.className="powerText",m.innerHTML="Power: 0",game.appendChild(m),l()}var currentLevel=0;const startWindow=document.getElementById("Start"),gameWindow=document.getElementById("Main"),endWindow=document.getElementById("End"),game=document.getElementById("Game"),howWindow=document.getElementById("How"),listBtn=document.getElementById("list"),levelWindow=document.getElementById("Level");listBtn.addEventListener("click",()=>{howWindow.style.display="none",levelWindow.style.display="block";const e=document.getElementById("level");e.innerHTML="";for(let n=0;n<12;n++){let t=document.createElement("div");t.className="level",t.innerHTML="Level "+(n+1),t.addEventListener("click",()=>{levelWindow.style.display="none",startWindow.style.display="none",game.style.display="block",LoadLevel(n)}),e.appendChild(t)}}),document.getElementById("X2").addEventListener("click",()=>{levelWindow.style.display="none"}),document.getElementById("X").addEventListener("click",()=>{howWindow.style.display="none"}),document.getElementById("how").addEventListener("click",()=>{howWindow.style.display="block",levelWindow.style.display="none"}),document.getElementById("next").addEventListener("click",()=>{endWindow.style.display="none",currentLevel<11?LoadLevel(currentLevel+1):(game.style.display="none",startWindow.style.display="block",howWindow.style.display="none")}),levelWindow.style.display="none",howWindow.style.display="none",startWindow.style.display="block",game.style.display="none",endWindow.style.display="none";const startBtn=document.getElementById("StartBtn");startBtn.addEventListener("click",()=>{startWindow.style.display="none",game.style.display="block",endWindow.style.display="none",LoadLevel(0)});var inGaming=!1;const windowBorder=50;var centerX,centerY,player,currentMap,levels=[[[1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,3,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,4,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,5,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1]],[[1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,1,0,0,0,0,0,1],[1,0,0,0,0,1,3,0,0,0,0,1],[1,0,0,0,0,1,1,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,5,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,4,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1]],[[1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,4,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,3,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,5,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1]],[[1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,3,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,0,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,4,0,0,3,0,0,1],[1,1,1,1,1,4,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,5,0,1],[1,1,1,1,1,1,1,1,1,1,1,1]],[[1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,1,0,0,0,1,0,3,1],[1,0,0,0,1,0,0,0,1,0,0,1],[1,0,0,0,1,0,0,0,1,0,3,1],[1,0,0,0,1,0,0,0,1,0,0,1],[1,5,0,0,4,0,4,0,4,0,3,1],[1,0,0,0,1,0,0,0,1,0,0,1],[1,0,0,0,1,0,0,0,1,0,0,1],[1,0,0,0,1,0,0,0,1,0,0,1],[1,0,0,0,1,0,0,0,1,0,0,1],[1,0,0,0,1,0,0,0,1,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1]],[[1,1,1,1,1,1,1,1,1,1,1,1],[1,3,0,0,0,0,0,0,0,0,3,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,4,4,0,0,0,0,1],[1,0,0,0,0,4,4,0,0,0,0,1],[1,5,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,3,0,0,0,0,0,0,0,0,3,1],[1,1,1,1,1,1,1,1,1,1,1,1]],[[1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1]],[[1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1]],[[1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1]],[[1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1]],[[1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1]],[[1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1]]];document.addEventListener("keydown",e=>{inGaming&&PlayerMove(e.code,playerPos)}),window.addEventListener("resize",ResizeWindow);var playerPos,moving,boxPos,boxes,mS=12,n=mS/2-.5,s=80;ResizeWindow();